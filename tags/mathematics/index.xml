<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Mathematics on CodeAndBugs</title><link>https://www.codeandbugs.com/tags/mathematics/</link><description>Recent content in Mathematics on CodeAndBugs</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Thu, 05 Oct 2023 08:29:19 +0200</lastBuildDate><atom:link href="https://www.codeandbugs.com/tags/mathematics/index.xml" rel="self" type="application/rss+xml"/><item><title>The mystery of the second regression line</title><link>https://www.codeandbugs.com/post/second-regression-line/</link><pubDate>Thu, 05 Oct 2023 08:29:19 +0200</pubDate><guid>https://www.codeandbugs.com/post/second-regression-line/</guid><description>&lt;p&gt;A few days ago I was stumped by a question that came up while studying Chapter
10 &amp;ldquo;Regression&amp;rdquo; of &lt;em&gt;Statistics&lt;/em&gt; by Freedman, Pisani and Purves.&lt;/p&gt;
&lt;p&gt;The context is regression with two variables.&lt;/p&gt;
&lt;p&gt;Notation:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;σ (sigma) and SD: standard deviation&lt;/li&gt;
&lt;li&gt;μ (mu): mean&lt;/li&gt;
&lt;li&gt;r: Pearson correlation coefficient&lt;/li&gt;
&lt;li&gt;x and y: the two variables&lt;/li&gt;
&lt;li&gt;$\sigma_x$: standard deviation of x&lt;/li&gt;
&lt;li&gt;$\mu_x$: mean of x&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Chapter 8 had introduced the concept of the &lt;em&gt;SD line&lt;/em&gt;, which is the line that
crosses the point of means $(\mu_x,\mu_y)$ as well as
$(\mu_x+\sigma_x,\mu_y+\sigma_y)$, $(\mu_x-\sigma_x,\mu_y-\sigma_y)$,
$(\mu_x+2\cdot\sigma_x,\mu_y+2\cdot\sigma_y)$ and all other points that are an
equal number of SDs away from the point of means.&lt;/p&gt;
&lt;p&gt;For example here is a scatter diagram of ficticious height and weight data with
the &lt;em&gt;SD line&lt;/em&gt;. For those less familiar with the metric system, the mean
values 171cm and 87kg are about 5ft 7in and 192lb respectively.&lt;/p&gt;
&lt;p&gt;&lt;img src="plot1.svg" alt="Scatter plot with SD line" title="Scatter plot with SD line"&gt;&lt;/p&gt;
&lt;p&gt;Chapter 8 also introduces the correlation coefficient $r$ which measures how
strong the linear association between the variables is. The closer it is to 1
(or -1) the stronger the variables are associated. In Chapter 9 we learn that
the correlation coefficient does not change if we interchange the variables.
That is, weight is as correlated with height as height is with weight.&lt;/p&gt;
&lt;p&gt;In our example case $r = 0.462$&lt;/p&gt;
&lt;p&gt;In Chapter 10 the idea of the regression line is introduced. The regression
line is a line that best fits the data, minimizing vertical distance to the
points. It allows to predict for each value of x (height) the mean value of
y (weight). The chapter also explains that the slope of the &lt;em&gt;SD line&lt;/em&gt; is
$\frac{\sigma_y}{\sigma_x}$ and the slope of the regression line is
$r\frac{\sigma_y}{\sigma_x}$&lt;/p&gt;
&lt;p&gt;&lt;img src="plot2.svg" alt="Scatter plot with SD line and regression line" title="Scatter plot with
SD line and regression line"&gt;&lt;/p&gt;
&lt;p&gt;This green regression line will tell you for each value of x (height) the mean
value of y (weight). If you divide the plot into columns, the regression line
aproximately passes through the mean y (weight) value within each column.&lt;/p&gt;
&lt;p&gt;So far so good.&lt;/p&gt;
&lt;p&gt;Then, however, we learn that there is a second regression line, namely the one
that for each value of $y$ (weight) predicts the mean value of $x$ (height). That
might sound similar, but is not the same thing. If you divide the plot into
rows, this second regression line will aproximately pass through the mean x
(height) value for each row.&lt;/p&gt;
&lt;p&gt;The book gives no further details on how to calculate this second regression
line. What is its slope? We know that $r$ never changes and that the slope
must depend on $\sigma_x$ and $\sigma_y$ in some way. Therefore, it must be
$r\frac{\sigma_x}{\sigma_y}$, right? We just invert the standard deviations.&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s plot the result.&lt;/p&gt;
&lt;p&gt;&lt;img src="plot3.svg" alt="Scatter plot with SD line, one correct and one incorrect regression
line" title="Scatter plot with SD line, one correct and one incorrect
regression line"&gt;&lt;/p&gt;
&lt;p&gt;It looks off. In the examples in the book both regression lines were
symmetrical with respect to the &lt;em&gt;SD line&lt;/em&gt;, whereas here the first regression
line is between the second regression line and the &lt;em&gt;SD line&lt;/em&gt;. Also, the second
regression line is supposed to minimize the horizontal distance to the points.
If you look at the bottom of the graph you can see that the line is far away
from all points. The same is true for the top of the graph.&lt;/p&gt;
&lt;p&gt;In the image below I have marked the points that are too far away from the
second (orange) regression line with red circles. Remember that now we are
trying to minimize the HORIZONTAL distance, which I have indicated with the
olive-green colored arrows.&lt;/p&gt;
&lt;p&gt;&lt;img src="plot3_notes.svg" alt="Scatter plot with SD line, one correct and one incorrect regression line as
well as some notes" title="Scatter plot with SD line, one correct and
one incorrect regression line as well as some notes"&gt;&lt;/p&gt;
&lt;p&gt;So, what should we change? If we use $r\frac{\sigma_y}{\sigma_x}$ we get the
slope of the first regression line, which can&amp;rsquo;t be right. And we know $r$
cannot change.&lt;/p&gt;
&lt;p&gt;This is the mystery I was pondering. What is the slope given the above
constraints?&lt;/p&gt;
&lt;p&gt;The solution to the mystery is that the second regression line calculates $x$
with respect to $y$. So the equation is $x = slope \cdot y + intercept$. And
here slope is precisely $r\frac{\sigma_x}{\sigma_y}$. If we re-order the terms
to have $y$ on the left hand as is usual we get $y = \frac{x -
intercept}{slope} = \frac{1}{slope}x - \frac{intercept}{slope}$&lt;/p&gt;
&lt;p&gt;And $\frac{1}{slope}$ is the same as $\frac{1}{r} \cdot
\frac{\sigma_y}{\sigma_x}$ so the only thing that changes between the slopes of
the two regression lines is that the first one includes $r$ and the second one
$\frac{1}{r}$&lt;/p&gt;
&lt;p&gt;We can now plot that line and voilà.&lt;/p&gt;
&lt;p&gt;&lt;img src="plot4.svg" alt="Scatter plot with SD line and two correct regression lines" title="Scatter plot with SD line and two correct regression lines"&gt;&lt;/p&gt;
&lt;p&gt;The equation of the &lt;em&gt;SD line&lt;/em&gt; is: $y = 1.38\cdot x - 149$&lt;/p&gt;
&lt;p&gt;The equation of the first regression line (green) is: $y = 0.638\cdot x - 22$&lt;/p&gt;
&lt;p&gt;The equation of the second regression line (orange) is: $y = 2.99\cdot x - 424$&lt;/p&gt;
&lt;p&gt;You can verify for yourself that if you multiply $r$ by the slope of the &lt;em&gt;SD
line&lt;/em&gt; (1.38) you&amp;rsquo;ll get the slope of the first (green) regression line and if you
multiply $\frac{1}{r}$ by the slope of the &lt;em&gt;SD line&lt;/em&gt; you&amp;rsquo;ll get the slope of
the second (orange) regression line.&lt;/p&gt;
&lt;p&gt;If we normalize the data (i.e. center on the mean and plot each point as the
number of SDs distance to the mean) then the slope of the &lt;em&gt;SD line&lt;/em&gt; will always
be 1, the slope of the first regression line will be $r$ and the slope of the
second regression line $\frac{1}{r}$ (since both SDs are 1 by definition).&lt;/p&gt;
&lt;p&gt;&lt;img src="plot5.svg" alt="Scatter plot with SD line and two correct regression lines
(normalized)" title="Scatter plot with SD line and two correct regression
lines (normalized)"&gt;&lt;/p&gt;
&lt;p&gt;The equations in the normalized plot are as follows.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;SD line&lt;/em&gt;: $y = x$&lt;/p&gt;
&lt;p&gt;First regression line (green): $y = 0.462\cdot x$&lt;/p&gt;
&lt;p&gt;Second regression line (orange): $y = 2.165\cdot x$&lt;/p&gt;
&lt;p&gt;You can find the Python code used to generate the data and plots on GitHub:
&lt;a href="https://gist.github.com/omarkohl/433968aa54d75e34a5c8b5c50a259ed7"&gt;https://gist.github.com/omarkohl/433968aa54d75e34a5c8b5c50a259ed7&lt;/a&gt;&lt;/p&gt;</description></item><item><title>Statistical Discrimination</title><link>https://www.codeandbugs.com/post/statistical-discrimination/</link><pubDate>Thu, 13 Apr 2023 09:15:50 +0200</pubDate><guid>https://www.codeandbugs.com/post/statistical-discrimination/</guid><description>&lt;p&gt;Let&amp;rsquo;s assume &lt;em&gt;Rivermoor College&lt;/em&gt; offers 100 open spots for next year.&lt;/p&gt;
&lt;p&gt;&lt;img src="./simpsons_paradox_open-spots.webp" alt=""&gt;&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s also assume that 100 women apply &amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;img src="./simpsons_paradox_female-applicants.webp" alt=""&gt;&lt;/p&gt;
&lt;p&gt;&amp;hellip; as well as 100 men.&lt;/p&gt;
&lt;p&gt;&lt;img src="./simpsons_paradox_male-applicants.webp" alt=""&gt;&lt;/p&gt;
&lt;p&gt;The women and men are equally well qualified. There are also no differences
concerning race, sexual orientation or some other common discrimination
factors.&lt;/p&gt;
&lt;p&gt;At the end of the application process the result is that 60 out of 100 men
(i.e. 60%) were accepted to this college but only 40 out of 100 women (40%).
Can we conclude that sex-based discrimination took place?&lt;/p&gt;
&lt;p&gt;&lt;img src="./simpsons_paradox_accepted-applicants.webp" alt=""&gt;&lt;/p&gt;
&lt;p&gt;No matter if your answer is Yes or No, please spend a few minutes thinking
about WHY you could be right or wrong before you continue reading. How sure are
you? Imagine reading the headline: &lt;em&gt;Study finds &amp;ldquo;Rivermoor College&amp;rdquo; accepts 40%
of women and 60% of men&lt;/em&gt;. Would you feel outrage? Would you be convinced from
the beginning that this can&amp;rsquo;t be true?&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Whitespace to encourage you to think&amp;hellip;&lt;/em&gt;&lt;/p&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;p&gt;Below is a legend for how to read all the diagrams in this post.&lt;/p&gt;
&lt;p&gt;&lt;img src="./simpsons_paradox_legend.webp" alt=""&gt;&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s look more closely what majors this college offers. Namely three different
majors that we&amp;rsquo;ll call A, B and C. The number of spots they offer for different
majors differs, however. 70 spots for major A, 20 spots for major B and 10
spots for major C.&lt;/p&gt;
&lt;p&gt;&lt;img src="./simpsons_paradox_open-spots-by-major.webp" alt=""&gt;&lt;/p&gt;
&lt;p&gt;Now let&amp;rsquo;s look at how many women and how many men apply to each major.&lt;/p&gt;
&lt;p&gt;Major A (with 70 open spots) gets 20 applications by women and 80 applications
by men.&lt;/p&gt;
&lt;p&gt;&lt;img src="./simpsons_paradox_major-a.webp" alt=""&gt;&lt;/p&gt;
&lt;p&gt;Major B (with 20 open spots) gets 20 applications by women and 10 applications
by men.&lt;/p&gt;
&lt;p&gt;&lt;img src="./simpsons_paradox_major-b.webp" alt=""&gt;&lt;/p&gt;
&lt;p&gt;Major C (with 10 open spots) gets 60 applications by women and 10 applications
by men.&lt;/p&gt;
&lt;p&gt;&lt;img src="./simpsons_paradox_major-c.webp" alt=""&gt;&lt;/p&gt;
&lt;p&gt;As we can see, men and women differ in their preferences.&lt;/p&gt;
&lt;p&gt;How are the acceptance rates within the majors?&lt;/p&gt;
&lt;p&gt;For major A, 15 out of 20 women get accepted (75%) and 55 out of 80 men (69%).&lt;/p&gt;
&lt;p&gt;&lt;img src="./simpsons_paradox_accepted-major-a.webp" alt=""&gt;&lt;/p&gt;
&lt;p&gt;Therefore, there is in fact discrimination against the men (because they are
less likely to get into the major they applied for, even though there is no
meaningful distinction between them and the women applying).&lt;/p&gt;
&lt;p&gt;The same is true for major B. 16 out of 20 women (80%) and 4 out of 10 men
(40%) get accepted.&lt;/p&gt;
&lt;p&gt;&lt;img src="./simpsons_paradox_accepted-major-b.webp" alt=""&gt;&lt;/p&gt;
&lt;p&gt;And for major C. 9 out of 60 women (15%) and 1 out of 10 men (10%) get
accepted.&lt;/p&gt;
&lt;p&gt;&lt;img src="./simpsons_paradox_accepted-major-c.webp" alt=""&gt;&lt;/p&gt;
&lt;p&gt;Below are all the numbers summarized in a table.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Major&lt;/th&gt;
&lt;th&gt;Open Spots&lt;/th&gt;
&lt;th colspan="3"&gt;Women&lt;/th&gt;
&lt;th colspan="3"&gt;Men&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;Applicants&lt;/th&gt;
&lt;th&gt;Accepted&lt;/th&gt;
&lt;th&gt;% Accepted&lt;/th&gt;
&lt;th&gt;Applicants&lt;/th&gt;
&lt;th&gt;Accepted&lt;/th&gt;
&lt;th&gt;% Accepted&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;th&gt;A&lt;/th&gt;
&lt;td&gt;70&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;15&lt;/td&gt;
&lt;td&gt;75%&lt;/td&gt;
&lt;td&gt;80&lt;/td&gt;
&lt;td&gt;55&lt;/td&gt;
&lt;td&gt;69%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;B&lt;/th&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;80%&lt;/td&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;40%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;C&lt;/th&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;15%&lt;/td&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;10%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;Total&lt;/th&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;td&gt;40&lt;/td&gt;
&lt;td&gt;40%&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;td&gt;60&lt;/td&gt;
&lt;td&gt;60%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;For any woman it is more likely she will get into the major she wants than for
an equally qualified man and yet overall it looks like women are being
discriminated against. The reason being that the women show a preference for
the majors with fewer spots (i.e. the ones where it&amp;rsquo;s harder to get into). The
real discriminatory trend against men reverses when combining the groups giving
the impression of discrimination against women.&lt;/p&gt;
&lt;p&gt;This phenomenon is called Simpson&amp;rsquo;s paradox.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Simpson&amp;rsquo;s paradox is a phenomenon in probability and statistics in which a
trend appears in several groups of data but disappears or reverses when the
groups are combined. This result is often encountered in social-science and
medical-science statistics, and is particularly problematic when frequency
data are unduly given causal interpretations.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/Simpson%27s_paradox"&gt;Wikipedia&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; The point of this post is not to claim that everything that looks
like discrimination is in fact a statistical effect or is in fact reverse
discrimination. The reason for choosing a hypothetical example with sexual
discrimination is to make you, the reader, more likely to remember Simpson&amp;rsquo;s
paradox. I suspect that we as humans remember things that cause strong emotions
better, in particular if they look like injustice. The data I use is completely
made up. &lt;em&gt;Rivermoor College&lt;/em&gt; does not exist as far as I know and should such a
college exist that is a mere coincidence. I acknowledge that for simplicity
this post assumed two genders but this is not meant to discriminate against
anyone who does not identify with said genders.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; Were you immediately convinced that the &lt;em&gt;Rivermoor College&lt;/em&gt; headline
could only be a lie and are you feeling smug right now? How could a single
headline give you enough information to come to such a strong conclusion? Did
you in fact have multiple hypotheses in mind, one of which should have been
&amp;ldquo;real discrimination against women is taking place&amp;rdquo;?&lt;/p&gt;
&lt;p&gt;Diagrams created with Inkscape. &lt;a href="./simpsons_paradox.svg"&gt;Source file&lt;/a&gt;.&lt;/p&gt;</description></item></channel></rss>